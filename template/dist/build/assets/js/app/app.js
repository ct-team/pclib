define('rule3-tpl',function(){return '<div class="rule rule3"><div class="top"><span></span><a href="javascript:;" class="layui-layer-close layui-layer-close1"></a></div><div class="content"><div class="wrap wrap2"><h3></h3><ul><li><i></i>系统将根据您注册时的IP自动为您选择所在省份，所有用户的战力（妖豆豆）总和=该省份战力；</li><li><i></i>排名前七名的省份，每位玩家可获得该地区相应比例的妖豆豆；</li><li><i></i>如妖豆豆数量相同，则以达到时间先后进行排名；</li><li><i></i>活动结束后，前七名的省份，每位玩家获得相应比例奖励：<table><tr><td class="td-title">名次</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><td class="td-title">获得妖豆豆比例</td><td>100%</td><td>60%</td><td>50%</td><td>40%</td><td>30%</td><td>20%</td><td>10%</td></tr></table></li><li><i></i>除妖豆豆奖励外，排名前三地区玩家还可获得同城游大厅每日活动广告位1日展示权利/全游戏频道内祝贺喊话/获胜省会举办线下玩家见面会/游戏内特定称号；</li></ul></div></div></div>'});
define('rule2-tpl',function(){return '<div class="rule rule2"><div class="top"><span></span><a href="javascript:;" class="layui-layer-close layui-layer-close1"></a></div><div class="content"><div class="wrap wrap1"><h3></h3><ul><li><i></i>在竞技场中，系统将自动为您匹配实力相仿玩家（其中两位玩家在您的<br><em></em>排名之前，三位玩家在您的排名之后）；</li><li><i></i>您需要选择任意玩家进行PK，如果您的妖豆豆数量高于对方，则获得胜<br><em></em>利，获得对方<span class="s-orange">8%的妖豆豆</span>，如果低于对方，则遗憾落败，给对方<span class="s-orange">5%的妖<br><em></em>豆豆</span>；</li><li><i></i>当对方将您打败后，您可以选择向他复仇，复仇成功可获得对方<span class="s-orange">5%妖豆<br><em></em>豆</span>，如果失败，则给对方<span class="s-orange">2%妖豆豆</span>；</li><li><i></i>您每天有5次免费挑战次数，超过5次，每挑战1次都需提交<span class="s-orange">1000颗妖豆<br><em></em>豆</span>作为入场费，复仇不需要付入场费；</li><li><i></i>当日已经挑战过的玩家不可进行二次挑战；复仇次数上限为10次，复仇<br><em></em>成功后，您的仇家将自动移除，复仇有风险，建议增强实力后再进行复<br><em></em>仇；</li><li><i></i>累计充值每满100元，可增加50000妖豆豆，如出现妖豆豆有小数点，将<br><em></em>舍去小数点取整数；</li><li><i></i>妖豆豆仅限在本次活动中使用，在活动结束后三天内可兑换妖券或者<br><em></em>实物奖励，若有问题，请直接联系 <a href="javascript:;" target="_blank" class="s-orange J-qqserver">妖豆客服中心</a>；</li></ul></div></div></div>'});
define('rule1-tpl',function(){return '<div class="rule rule1"><div class="top"><span></span><a href="javascript:;" class="layui-layer-close layui-layer-close1"></a></div><div class="content"><div class="wrap wrap1"><h3></h3><ul><li><i></i>在竞技场中，系统将自动为您匹配实力相仿玩家（其中两位玩家在您的排名之前，三位玩家在您的排名之后）；</li><li><i></i>您需要选择任意玩家进行PK，如果您的妖豆豆数量高于对方，则获得胜利，获得对方<span class="s-orange">8%的妖豆豆</span>，如果低于对方，则遗憾落<br><em></em>败，给对方<span class="s-orange">5%的妖豆豆</span>；</li><li><i></i>当对方将您打败后，您可以选择向他复仇，复仇成功可获得对方<span class="s-orange">5%妖豆豆</span>，如果失败，则给对方<span class="s-orange">2%妖豆豆</span>；</li><li><i></i>您每天有5次免费挑战次数，超过5次，每挑战1次都需提交<span class="s-orange">1000颗妖豆豆</span>作为入场费，复仇不需要付入场费；</li><li><i></i>当日已经挑战过的玩家不可进行二次挑战；复仇次数上限为10次，复仇成功后，您的仇家将自动移除，复仇有风险，建议增<br><em></em>强实力后再进行复仇；</li><li><i></i>累计充值每满100元，可增加50000妖豆豆，如出现妖豆豆有小数点，将舍去小数点取整数；</li><li><i></i>妖豆豆仅限在本次活动中使用，在活动结束后三天内可兑换妖券或者实物奖励，若有问题，请直接联系 <a href="javascritp:;" target="_blank" class="s-orange J-qqserver">妖豆客服中心</a>；</li></ul></div><div class="wrap wrap2"><h3></h3><ul><li><i></i>系统将根据您注册时的IP自动为您选择所在省份，所有用户的战力（妖豆豆）总和=该省份战力；</li><li><i></i>排名前七名的省份，每位玩家可获得该地区相应比例的妖豆豆；</li><li><i></i>如妖豆豆数量相同，则以达到时间先后进行排名；</li><li><i></i>活动结束后，前七名的省份，每位玩家获得相应比例奖励：<table><tr><td class="td-title">名次</td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td><td>6</td><td>7</td></tr><tr><td class="td-title">获得妖豆豆比例</td><td>100%</td><td>60%</td><td>50%</td><td>40%</td><td>30%</td><td>20%</td><td>10%</td></tr></table></li><li><i></i>除妖豆豆奖励外，排名前三地区玩家还可获得同城游大厅每日活动广告位1日展示权利/全游戏频道内祝贺喊话/获胜省会举办<br><em></em>线下玩家见面会/游戏内特定称号；</li></ul></div></div></div>'});
/**
 * 数字滚动动画
 */

define('handle-countup',function (require, exports, module) {

    function init(idCls, number) {
        new countUp(idCls, 0, number, 0, .4, {
            useEasing: true,
            useGrouping: true,
            separator: '',
            decimal: '.'
        }).start();
    }

    module.exports = {
        init: init
    }
});
define('format-time',function (require, exports, module) {

    Date.prototype.Format = function (fmt) {
        var o = {
            "M+": this.getMonth() + 1, // 月份
            "d+": this.getDate(), // 日
            "h+": this.getHours(), // 小时
            "m+": this.getMinutes(), // 分
            "s+": this.getSeconds(), // 秒
            "q+": Math.floor((this.getMonth() + 3) / 3), // 季度
            "S": this.getMilliseconds() // 毫秒
        };
        if (/(y+)/.test(fmt))
            fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in o)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
        return fmt;
    };

    function getCurDate(){
        return new Date().Format("yyyy-MM-dd");
    }

    function formatJoin(t) {
        var da = t;
        da = new Date(da);
        var year = da.getFullYear();
        var month = da.getMonth() + 1;
        var date = da.getDate();
        var time = [year, month, date].join('');
        return time;
    }

    function formatYearMonthDay(t) {
        var da = t;
        da = new Date(da);
        var year = da.getFullYear() + '年';
        var month = da.getMonth() + 1 + '月';
        var date = da.getDate() + '日';
        var h = da.getHours() < 10 ? '0' + da.getHours() : da.getHours();
        var m = da.getMinutes() < 10 ? '0' + da.getMinutes() : da.getMinutes();
        var time = [month, date].join('') + [h, m].join(':');
        return time;
    }

    function format(t) {
        var da = t;
        da = new Date(da);
        var year = da.getFullYear() + '年';
        var month = da.getMonth() + 1;
        var date = da.getDate();
        var h = da.getHours() < 10 ? '0' + da.getHours() : da.getHours();
        var m = da.getMinutes() < 10 ? '0' + da.getMinutes() : da.getMinutes();
        var time = [month, date].join('.') + ' ' + [h, m].join(':');
        return time;
    }

    module.exports = {
        format: format,
        formatYearMonthDay: formatYearMonthDay,
        formatJoin: formatJoin,
        getCurDate: getCurDate
    }
});
define('handle-rule',['url','rule1-tpl','rule2-tpl','rule3-tpl'],function (require, exports, module) {
    var url = require('url');
    var rule1Tpl = require('rule1-tpl');
    var rule2Tpl = require('rule2-tpl');
    var rule3Tpl = require('rule3-tpl');

    function handle(){
        var aArea = [[695,543],[420,515],[591,320]]; // 440,390
        var ruleTpl = [rule1Tpl, rule2Tpl, rule3Tpl];

        $('.J-rule').click(function(){
            var dataId = $(this).attr('data-id');
            wht.dialog({
                type: 'personal',
                skin: 'layer-ext-rule'+dataId,
                area: aArea[dataId-1],
                close: function(){},
                complete: function(){
                    $('.J-qqserver').attr('href', url.other.qqCustomServer);
                },
                body: {
                    content: ruleTpl[dataId-1]
                }
            });
        });
    }

    function init() {
        handle();
    }

    module.exports = {
        init: init
    }
});

define('handle-recharge',['url','format-time','commdata'],function (require, exports, module) {
    var url = require('url');
    var formatTime = require('format-time');
    var commdata = require('commdata');

    function handleIsRecharge(fn){
        wht.dialog({
            title: '提示',
            close: function(){
                if(typeof fn === 'function'){
                    fn();
                }
            },
            body: {
                content: '<span class="h3-1">是否完成充值</span>',
                btn: [{
                    text: '取消',
                    css: 'skin-btn-2'
                }, {
                    text: '确定',
                    css: 'skin-btn-1'
                }]
            }
        });
    }

    function handle(fn){
        $('.J-recharge').click(function(){
            var timeCode = formatTime.formatJoin(commdata.getActTime().StartTime)+'01';
            $(this).attr('href', url.other.recharge+'actCode='+timeCode);
            handleIsRecharge(fn);
        });
    }

    function init(fn) {
        handle(fn);
    }

    module.exports = {
        init: init,
        handleIsRecharge: handleIsRecharge
    }
});
define('render-personal',['url','commdata','handle-countup'],function (require, exports, module) {
    var url = require('url');
    var commdata = require('commdata');
    var handleCountup = require('handle-countup');

    function getRankId(n) {
        return n == 0 ? '暂无排名' : '第' + n + '名';
    }

    function dealfnPersonInfo(result){
        var $JyddCount = $('.J-yddcount');
        var $JPersonRankId = $('.J-person-rankid');
        var yddCount;
        var personRankId;
        var areaId;
        if (result.Code === wht.code.SUCCESS) {
            yddCount = result.Data.PersonRank.YddCount;
            personRankId = getRankId(result.Data.PersonRank.RankId);
            areaId = result.Data.PersonRank.AreaId;
        } else {
            yddCount = '0';
            personRankId = getRankId(0);
        }
        
        // 妖豆豆数量加载需要动画效果
        handleCountup.init('J-yddcount'+commdata.getCurActId(),yddCount);  
        // $JyddCount.html(yddCount);
        $JPersonRankId.html(personRankId);

        // 如果是活动2的话，则需要显示个人省份信息的图片
        var curActId = commdata.getCurActId();
        if(curActId === 2){
            $('.J-personal-info-img').css('background-image', 'url('+url.imgUrl.personnalImg+'p'+areaId+'.jpg)').load(function () {
                $(this).fadeIn();
            });
        }
    }

    function handlePersonInfo() {
        wht.ajax({
            url: url.api.personinfo,
            success: function (result) {
                dealfnPersonInfo(result);
            }
        });
    }

    function init() {
        handlePersonInfo();
    }

    module.exports = {
        init: init
    }
});
define('render-acttime',['commdata','format-time'],function (require, exports, module) {
    var commdata = require('commdata'); // 公用数据
    var formatTime = require('format-time'); // 格式化时间

    function handleActTimeA4() {
        // 这里从全局变量去取数据
        var exgTimeS = formatTime.formatYearMonthDay(commdata.getActTime().ExgStartTime);
        var exgTimeE = formatTime.formatYearMonthDay(commdata.getActTime().ExgEndTime);
        var time = exgTimeS + ' - ' + exgTimeE;
        // $('.J-exg-time').html(time);
        // 返回的时间用于弹窗显示
        return time;
    }

    function handleActTimeA2() {
        // 这里从全局变量去取数据
        var actTimeS = formatTime.format(commdata.getActTime().StartTime);
        var actTimeE = formatTime.format(commdata.getActTime().EndTime);
        var exgTimeS = formatTime.format(commdata.getActTime().ExgStartTime);
        var exgTimeE = formatTime.format(commdata.getActTime().ExgEndTime);
        $('.J-pk-time').html(actTimeS + ' - ' + actTimeE);
        $('.J-exg-time').html(exgTimeS + ' - ' + exgTimeE);
    }

    function handleActTimeA1() {
        // 这里从全局变量去取数据
        var actTimeS = formatTime.formatYearMonthDay(commdata.getActTime().StartTime);
        var exgTimeE = formatTime.formatYearMonthDay(commdata.getActTime().ExgEndTime);
        $('.J-act-time').html(actTimeS + ' - ' + exgTimeE);
    }

    module.exports = {
        handleActTimeA1: handleActTimeA1,
        handleActTimeA2: handleActTimeA2,
        handleActTimeA4: handleActTimeA4
    }
});
/**
 * 判断是否登录
 */
define('islogin',function(require, exports, module) {

    /**
     * 得到cookie信息
     * @param name
     * @returns {*}
     */
    function getCookie(name) {
        var arr, reg = new RegExp("(^| )" + name + "=([^;]*)(;|$)");
        if (arr = document.cookie.match(reg)) {
            return decodeURI(arr[2]);
        } else {
            return null;
        }
    }

    function isLogin(){
        var result, username;
        username = getCookie("UC108_NickName");
        result = username ? username : false;
        // result = 'ql2015';
        return result;
    }

    function init() {
        return isLogin();
    }

    module.exports = {
        init: init
    };
});

define('countdown',function() {
    'use strict';
    function CountDown(options) {
        this.timer = null;
        this.opts = CountDown.DEFAULT_OPTIONS;
        for (var key in options) {
            this.opts[key] = options[key];
        }
        this.runningTask = [];
        this.endTask = [];
        this.beginTime = new Date().valueOf();
        this.endTime = this.opts.endTime || (this.beginTime + (this.opts.offset || 0));
        this.start();
    }

    CountDown.DEFAULT_OPTIONS = {
        endTime: false,
        offset: false,
        delay: 200,
        dayUnit: false
    };

    CountDown.prototype.start = function() {
        var self = this;
        this.timer = setInterval(function() {
            self._running();
        }, this.opts.delay);
    };

    CountDown.prototype.stop = function() {
        clearInterval(this.timer);
        this.timer = null;
    };

    CountDown.prototype._end = function() {
        for (var i = 0; i < this.endTask.length; i++) {
            this.endTask[i]();
        }
        this.stop();
    };

    CountDown.prototype._calcOffsetTime = function(time) {
        var seconds = parseInt(time / 1e3) % 60,
            minutes = parseInt(time / 6e4) % 60,
            hours = parseInt(time / 36e5),
            days = parseInt(time / 864e5);
        if(this.opts.dayUnit){
            hours = hours % 24;
        }
        return {
            s: seconds,
            m: minutes,
            h: hours,
            d: days
        };
    };

    CountDown.prototype._running = function() {
        var now = new Date().valueOf();
        if (now > this.endTime) {
            return this._end();
        }
        var offsetTime = this._calcOffsetTime(this.endTime - now + 999);
        for (var i = 0; i < this.runningTask.length; i++) {
            this.runningTask[i](offsetTime.h, offsetTime.m, offsetTime.s, offsetTime.d);
        }
    };

    CountDown.prototype.on = function(eventName, callback) {
        switch (eventName) {
            case 'running':
                this.runningTask.push(callback);
                break;
            case 'end':
                this.endTask.push(callback);
                break;
            default:
        }
        return this;
    };

    return {
        CountDown: CountDown
    }
});
// 绑定和逻辑处理

define('a1-controller',['a1-render','handle-recharge','handle-rule'],function (require, exports, module) {
    var a1Render = require('a1-render'); // 渲染数据
    var handleRecharge = require('handle-recharge'); // 处理充值
    var handleRule = require('handle-rule'); // 处理规则

    function init() {
        handleRule.init(); // 处理规则
        handleRecharge.init(a1Render.initRank); // 处理充值
    }

    module.exports = {
        init: init
    };
});


// 渲染页面
define('a1-render',['countdown','islogin','url','judgestate','render-acttime','render-personal'],function (require, exports, module) {
    var countDown = require('countdown'); // 倒计时
    var islogin = require('islogin'); // 是否登录
    var url = require('url');
    var judgestate = require('judgestate'); // 判断
    var renderActTime = require('render-acttime'); // 活动时间渲染
    var renderPersonal = require('render-personal'); // 个人排名渲染
    // var a2Main = require('../a2/a2-main');
    // var actSwitch = require('../common-handle/act-switch'); // 切换到指定页面

    function getRankId(n) {
        return n == 0 ? '暂无排名' : '第' + n + '名';
    }

    // 渲染地区信息
    function dealfnAreaInfo(result) {
        var $JareaName = $('.J-area-name');
        var $JareaRankId = $('.J-area-rankid');
        var areaName;
        var areaRankId;
        if (result.Code === wht.code.SUCCESS) {
            areaName = result.Data.AreaRank.AreaName;
            areaRankId = getRankId(result.Data.AreaRank.RankId);
        } else {
            areaName = '暂无信息';
            areaRankId = getRankId(0);
        }
        $JareaName.html(areaName);
        $JareaRankId.html(areaRankId);
    }

    function handleAreaInfo() {
        wht.ajax({
            url: url.api.areainfo,
            success: function (result) {
                dealfnAreaInfo(result);
            }
        });
    }

    function formateNum(n) {
        return parseInt(n) < 10 ? '0' + n : n;
    }

    function PopTips() {
        wht.dialog({
            title: '提示',
            close: function () {
                layer.closeAll();
                alert('前往个人Pk活动');
                // 前往个人PK活动
                // a2Main.init();
                // actSwitch.setActShow(2);
            },
            body: {
                content: '<span class="h3-1">活动已开始<br/>请前往参加竞技</span>',
                btn: [{
                    text: '确定'
                }]
            }
        });
    }

    // 渲染倒计时
    function dealfnCountDown(result) {
        var $JcountDownTime = $('.J-counttime');
        var time;
        if (result.Code === wht.code.SUCCESS) {
            var countDownTime = countDown.CountDown;  //result.Data.Time = 3000;
            new countDownTime({
                offset: result.Data.Time
            }).on('running', function (h, m, s, d) {
                // console.log(h, m, s);
                // console.log(formateNum(h), formateNum(m), formateNum(s));
                time = formateNum(h) + '<span class="semicolon">:</span>' + formateNum(m) + '<span class="semicolon">:</span>' + formateNum(s);
                $JcountDownTime.html(time);
            }).on('end', function () {
                time = '00:00:00';
                $JcountDownTime.html(time);
                // 倒计时结束做弹窗操作
                PopTips();
            });
        } else {
            time = '00:00:00';
            $JcountDownTime.html(time);
        }
    }

    function handleCountTime() {   
        wht.ajax({
            url: url.api.countdown,
            success: function (result) { 
                dealfnCountDown(result);
            }
        });
    }

    function initRank() {
        handleAreaInfo();
        renderPersonal.init();
    }

    function init() {
        // 先确定初始化数据的接口是否和登陆有关系，是否是纯展示用的，在活动各个期间表现状态是否一样
        // 先判断是否登陆，登陆则请求，否则不请求

        var isLogin = islogin.init();
        if (!isLogin) {
            judgestate.init(wht.code.NO_LOGIN);
            return;
        }

        handleCountTime();
        renderActTime.handleActTimeA1();
        initRank();
    }

    module.exports = {
        init: init,
        initRank: initRank
    };
});

define('judgestate',function (require, exports, module) {
    /*var gCodeList = {
        11000: {content: '您未登录'}, // 未登录
        20002: {content: '活动未开始'}, // 活动未开始
        20003: {content: '活动已结束'}, // 活活动已结束
        // 20004: {content: '人品爆发啦，请稍后重试'}, // 活动预算不足
        20005: {content: '当前活动不可用'}, // 活动禁用  -- by add ql
        20001: {content: '人品爆发啦，请稍后重试'},  // 统一未知错误
        20101: {content: '人品爆发啦，请稍后重试'}, // 请求参数错误
        20102: {content: '人品爆发啦，请稍后重试'}, // 接口超时
        '-1': {content: '人品爆发啦，请稍后重试'}
    };*/

    var gArrCodeList = [11000, 20002, 20003, /*20004,*/ 20005, 20001, 20101, 20102, -1];

    function weakTip(str) {
        wht.dialog({
            body: {
                content: str,
                isWeak: true,
                weakType: 2
            }
        });
    }

    function init(status, n) {
        var bool = false;
        var gCodeList = {
            11000: {content: '您未登录'}, // 未登录
            20002: {content: '活动未开始'}, // 活动未开始
            20003: {content: '活动已结束'}, // 活活动已结束
            // 20004: {content: '人品爆发啦，请稍后重试'}, // 活动预算不足
            20005: {content: '当前活动不可用'}, // 活动禁用  -- by add ql
            20001: {content: '异常错误，错误值' + status},  // 统一未知错误
            20101: {content: '异常错误，错误值' + status}, // 请求参数错误
            20102: {content: '异常错误，错误值' + status}, // 接口超时
            '-1': {content: '异常错误，错误值' + n}
        };
        if ($.inArray(status, gArrCodeList) != -1) {
            weakTip(gCodeList[status].content);
            bool = true;
        }
        return bool;
    }

    module.exports = {
        init: init
    };
});
// 入口文件
define('a1-main',['a1-render','a1-controller'],function (require, exports, module) {
    var a1Render = require('a1-render'); // 渲染数据
    var a1Controller = require('a1-controller'); // 绑定和处理逻辑

    function init(){
        a1Render.init();
        a1Controller.init();
    }

    module.exports = {
        init: init
    };
});


/**
 * 公用数据
 */
define('commdata',function (require, exports, module) {
    var actTime; // 活动时间
    var curActId; // 当前活动ID值
    var areaRankId; // 所在地区排名

    function getActTime() {
        return this.actTime;
    }

    function setActTime(t) {
        this.actTime = t;
    }

    function getCurActId(){
        return this.curActId;
    }

    function setCurActId(t){
        this.curActId = t;
    }

    function setAreaRankId(t){
        this.areaRankId = t;
    }

    function getAreaRankId(){
        return this.areaRankId;
    }

    module.exports = {
        getActTime: getActTime,
        setActTime: setActTime,
        getCurActId: getCurActId,
        setCurActId: setCurActId,
        setAreaRankId: setAreaRankId,
        getAreaRankId: getAreaRankId
    }
});
define('url',function (require, exports, module) {
    // var vport = window.location.port == '1505' ? 'org:1505' : 'com';

    var gvport = window.location.port;
    var vport = {
        '1505': 'org:1505',
        '1506': 'org:1506',
        '1507': 'org:1507',
        '2505': 'com:2505',
        '': 'com'
    };

   var host = window.location.host;
   var isLocalHost = host == 'a.yaodou.org:1505';
   var pcHallUrlPre = 'tcynew://login.yaodou.com/halllogin.html?gourl=http:';
    module.exports = {
        // 和接口相关
        api: {
            //------------------use-----------------------
            actinfos: '/api/jjc/actinfos', // 活动基本信息
            personinfo: '/api/jjc/personinfo', // 个人信息
            areainfo: '/api/jjc/areainfo', // 地区信息
            countdown: '/api/jjc/countdown', // 得到倒计时时间
            //------------------use-----------------------
        },
        imgUrl: {
            personnalImg: isLocalHost ? '/src/assets/img/a2/persons-info/' : '//static.tcy365.'+ vport[gvport] +'/yd/action/jjc2018/assets/img/a2/persons-info/',
            areaImg: isLocalHost ? '/src/assets/img/a3/area-info/' :  '//static.tcy365.'+ vport[gvport] +'/yd/action/jjc2018/assets/img/a3/area-info/',
            gifUrl: isLocalHost ? '/src/assets/img/pk.gif':'//static.tcy365.'+ vport[gvport] +'/yd/action/jjc2018/assets/img/pk.gif',
            bar: isLocalHost? '/src/assets/img/a3/bar.png':'//static.tcy365.'+ vport[gvport] +'/yd/action/jjc2018/assets/img/a3/bar.png'
        },
        // 其他链接地址
        other:{
            YD_SITE: pcHallUrlPre+'//www.yaodou.com/',
            recharge: pcHallUrlPre+'//pay.yaodou.' + vport[gvport] + '/?', // 充值，需要在conf.js 配置具体活动日期,eg:actCode=2017070601
            recharge1: pcHallUrlPre+'//pay.yaodou.' + vport[gvport] + '/?actCode=201801', // 未使用：活动1 充值
            recharge2: pcHallUrlPre+'//pay.yaodou.' + vport[gvport] + '/?actCode=2017101002', // 未使用：活动2 充值
            vipcenter: pcHallUrlPre+'//vip.yaodou.' + vport[gvport]+'/', // 会员中心
            // qqCustomServer: 'http://crm2.qq.com/page/portalpage/wpa.php?uin=800059011&aty=1&a=1003&curl=&ty=1',
            qqCustomServer: pcHallUrlPre+'//talk.tcy365.com/client/?f=16', // 妖豆客服中心
            gameCenter: pcHallUrlPre+'//www.yaodou.' + vport[gvport] + '/gcenter/', // 游戏中心
            myCoupons: pcHallUrlPre+'//pay.yaodou.' + vport[gvport] + '/mycoupon/' //我的优惠券
        }
    };
});

/**
 * 活动初始化操作
 */
define('act-init',['url','commdata','a1-main','judgestate'],function (require, exports, module) {
    var url = require('url');
    var commdata = require('commdata'); // 全局数据
    var a1Main = require('a1-main'); // 活动1初始化
    // var a2Main = require('./a2/a2-main'); // 活动2初始化
    // var actSwitch = require('common-handle/act-switch'); // 切换到指定页面
    var judgestate = require('judgestate');

    function showActPage(r) {
        // 显示活动1
        var isA1 = r[0].Status === 1 && r[1].Status === 0 && r[2].Status === 0 && r[3].Status === 0;
        // 显示活动2
        var isA2 = r[0].Status === 2 && r[1].Status === 1 && r[2].Status === 1 && r[3].Status === 0;

        if (isA1) {
            a1Main.init();
            // 设置当前活动为活动n
            commdata.setCurActId(1);
            // actSwitch.setActShow(1);
        } else if (isA2) {
            // a2Main.init();
            // actSwitch.setActShow(2);
        }
    }

    function dealfn(result) {
        if (result.Code === wht.code.SUCCESS) {
            commdata.setActTime(result.Data.ActTime);
            showActPage(result.Data.actList);
        } else {
            // 出错的情况，直接显示预热页面，但是无法进行其他操作（其他优化方式：调整为 【网络异常，请重新加载，附带猴子图片和重新加载按钮】）
            judgestate.commonHandle({Code:wht.code.ERROR_UNIFY});
            // actSwitch.setActShow(1);
        }
    }

    function initPage() {
        // 不管是否登录都需要请求
        wht.ajax({
            url: url.api.actinfos,
            success: function (result) {
                dealfn(result);
            }
        });
    }

    function init() {
        initPage();
    }

    module.exports = {
        init: init
    }
});




define('wht-init',function(require, exports, module){

    function initCode(){
        wht.codeInit({
            // 活动通用的错误，！！！改动时只可改动value值，不可改动key值
            SUCCESS: 0, // 成功
            NO_LOGIN: 11000, // 未登录
            ERROR_UNIFY: 20001, // 统一未知错误
            ERROR_PARAM: 20101, // 请求参数错误
            NO_START: 20002, // 活动未开始
            END: 20003, // 活动已结束
            NOT_BUDGET: 20004, // 活动预算不足
            ERROR_OTHER: -1 // 其他错误

            // 活动具体的错误
        });
    }

    function initAjax(){
        wht.ajax({
            error: function () {
                wht.dialog({
                    body: {
                        content: '人品爆发啦，请稍后重试',
                        isWeak: true,
                        weakType: 2
                    }
                });
            }
        });
    }

    function init() {
        initCode();
        initAjax();
    }

    module.exports = {
        init:init
    }
});
define('app',['wht-init','act-init'],function (require, exports, module) {
  var whtInit = require('wht-init'); // 万花筒初始化


  var actInit = require('act-init'); // 初始化各个活动


  function init() {
    // 初始化万花筒
    whtInit.init(); // 初始化各个活动

    actInit.init();
  }

  module.exports = {
    init: init
  };
});
/*
var _html = '<div class="whtui-top">\n' +
    '    <div class="title">[title]</div>\n' +
    '    <a href="javascript:;" class="layui-layer-close layui-layer-close1"></a>\n' +
    '</div>\n' +
    '<div class="whtui">\n' +
    '    <div class="msg-con msg-con-list">\n' +
    '        <div class="msg-center clearfix">\n' +
    '            <h3 class="h3">[con]</h3>\n' +
    '            <ul class="msg-ul-list J-msgList">[msg-ul-list]</ul>\n' +
    '            <span class="sim">[sim]</span>\n' +
    '        </div>\n' +
    '    </div>\n' +
    '</div>';
// 个性化弹窗
$('.J-btn4').click(function () {
    wht.dialog({
        type: "personal",
        complete: function () {
            // $('')
        },
        body: {
            // 可选，可以是html模板，dom节点
            // content: '<div>hello word</div>',
            content: _html,
            // 可选，默认是【[]】
            btn: [{
                text: '任务中心',
                css: '', /!*skin-btn-1*!/
                href: 'http://www.yaodou.com',
                target: '_blank',
                // 默认为false,执行关闭事件（场景：有的弹窗操作了按钮后不需要关闭当前弹窗）
                isExeCloseE: true,
                action: function () {
                }
            }, {
                text: '取消'
            }]
        }
    });
});*/
